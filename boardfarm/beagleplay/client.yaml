targets:
  main:
    resources:
      RemotePlace:
        name: beagleplay
    drivers:
      - SerialDriver:
          name: 'bp-console-1'
          bindings:
            port: 'bp-serial-port-1'
      - GpioDigitalOutputDriver:
          name: 'bp-power-gpio-1'
          bindings:
            gpio: 'bp-power-gpio-1'
      - DigitalOutputPowerDriver:
          name: 'bp-power-1'
          bindings:
            output: 'bp-power-gpio-1'
      - TFTPProviderDriver:
          name: 'bp-tftp-1'
          bindings:
            provider: 'bp-tftp-1'
      - UBootDriver:
          prompt: '=> '
          autoboot: 'Press SPACE to abort autoboot in 2 seconds'
          interrupt: ' '
          name: 'bp-uboot-1'
          boot_commands:
            emmc: 'setenv bootargs "$bootargs console=ttyS2,115200n8 root=/dev/mmcblk0p3 ro rootfstype=ext4 resume=/dev/mmcblk0p2 rootwait net.ifnames=0"; fatload mmc 0:1 $kernel_addr_r Image; fatload mmc 0:1 $fdt_addr_r k3-am625-beagleplay.dtb; booti $kernel_addr_r - $fdt_addr_r'
            tftp: 'setenv bootargs "$bootargs console=ttyS2,115200n8 root=/dev/mmcblk0p3 ro rootfstype=ext4 resume=/dev/mmcblk0p2 rootwait net.ifnames=0"; setenv kernel_comp_addr_r 0x85000000; setenv kernel_comp_size 0x2000000; tftp $kernel_addr_r beagleplay/Image.gz; tftp $fdt_addr_r beagleplay/k3-am625-beagleplay.dtb; booti $kernel_addr_r - $fdt_addr_r'
          bindings:
            console: 'bp-console-1'
          login_timeout: 30
          boot_timeout: 30
      - ShellDriver:
          prompt: '\x1b\[\?2004hdebian@[\w-]+:[^ ]+ '
          login_prompt: '[-\w]+ login: '
          username: 'debian'
          password: 'debian'
          name: 'bp-shell-1'
          bindings:
            console: 'bp-console-1'
      - BeagleplayBootStrategy:
          name: 'bp-strategy-1'
          bindings:
            power: 'bp-power-1'
            console: 'bp-console-1'
            uboot: 'bp-uboot-1'
            shell: 'bp-shell-1'
            tftp: 'bp-tftp-1'

imports:
  - beagleplaybootstrategy.py
